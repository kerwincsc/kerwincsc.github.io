===========
 Rust 基础
===========

变量和常量的声明
================

变量
----

默认不可变;

不可变变量
**********

.. code-block:: rust
		
   let x = 5;

可变变量
********

.. code-block:: rust

   let mut x = 5;

常量
----

常量总是不能变;

.. code-block:: rust

   const MAX_POINTS: u32 = 100_000;

名称是 MAX_POINTS, 值是 100,000;

Rust 常量的命名规范是使用下划线分隔的大写字母单词,
并且可以在数字字面值中插入下划线来提升可读性;

不允许对常量使用 mut;

结构体
======

整个实例必须是可变的; Rust 并不允许只将某个字段标记为可变;

可以在函数体的最后一个表达式中构造一个结构体的新实例, 来隐式地返回这个实例;

字段初始化简写语法: 如果结构体中, 参数的名字和结构体的名称相同即可简写为

::

   fn build_user(email: String, username: String) -> User {
       User {
           email, // 原内容为: email: email,
	   username,
	   active: true,
	   sign_in_count: 1,
       }
   }

结构体更新语法: 使用旧实例的大部分值但改变其部分值来创建一个新的结构体实例

::

   let user2 = User {
       email: String::from("another@example.com"),
       username: String::from("anotherusername567"),
       ..user1 // 用旧实例 user1 的其余部分补全 user2 剩下的字段
   };

元组结构体
----------

有着结构体名称提供的含义, 但 **没有具体的字段名, 只有字段的类型**;

定义的每一个结构体有其自己的类型, 即使结构体中的字段有着相同的类型;

元组结构体实例类似于元组: 可以将其 *解构为单独的部分*,
也可以使用 **.** 后跟索引来访问单独的值;

使用
****

- 定义 ``struct Color(i32, i32, i32);``

- 初始化 ``let black = Color(0, 0, 0);``

- 使用 ``black.0``

类单元结构体
------------

一个没有任何字段的结构体;

类似于 **()**, 即 unit 类型;

用在你想要在某个类型上实现 trait 但不需要在类型中存储数据的时候;

枚举
====

可以将任意类型的数据放入枚举成员: 字符串, 数字类型, 结构体, 甚至是另一个枚举;

定义
----

.. code-block: rust

   enum Week {
       Monday,
       Tuesday,
       Wednedday,
       ...,
   }

控制流
======

match
-----

if let
------

match 的 " 简化版 ";

处理只匹配一个模式的值而忽略其他模式的情况;

可以在 if let 中包含一个 else;
else 块中的代码与 match 表达式中的 _ 分支块中的代码相同

包,模块,项目
============

结构体字段的公有性和私有性不受结构体自身的影响, 且可独立设定;
若结构体内有私有字段, 则必须提供公共关联函数来构造结构体实例;

将枚举设为公有, 则它的所有成员都将变为公有;

use
---

使用 use 将函数引入作用域的习惯用法: 将函数的父模块引入作用域;

优点是 可以清晰地表明函数不是在本地定义, 同时使完整路径的重复度最小化;

引入 结构体, 枚举和其他项时, 习惯是指定它们的完整路径;

as
----

使用 as 可解决: 将两个同名类型引入同一作用域的问题;

pub use
--------

当使用 use 关键字将名称导入作用域时, 在新作用域中可用的名称是私有的.
如果为了让调用你编写的代码的代码能够像在自己的作用域内引用这些类型,
可以结合 pub 和 use. 这个技术被称为 " 重导出 ( re-exporting )"


备忘
====

Rust中的基本数字类型都默认实现了 Copy Trait, 没有实现Copy Trait的变量，所有权就会被转移.

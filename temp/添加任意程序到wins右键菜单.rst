添加任意程序到wins右键菜单
======================================================================

添加一级菜单项
------------------------------------------------------------

#. 打开注册表, :kbd:`Win+R`, 输入 **regedit**;
#. 在 HKEY_CLASSES_ROOT 目录下, 依次展开: ``Directory\Background\shell``
#. 选中 shell, 右键, 新建项;
#. 将文件夹名字改为 QQ;
#. 再选择 QQ 文件夹, 右键, 新建项;
#. 将文件夹名字改为 **command**;
#. 再选择 **command** 文件夹, 在右端参数上双击, 打开编辑字符串, 输入待执行命令的路径;

添加二级菜单项
------------------------------------------------------------

#. 打开注册表, :kbd:`Win+R`, 输入 **regedit**;

#. 先创建一个子菜单项, 也就是二级菜单里面的每一个子文件;

   按照这个路径去寻找shell: ::

     HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\CommandStore\shell

   #. 找到 shell 之后右键单击找到新建, 然后在新建的子菜单中选择项, 创建一个项;
   #. 然后, 你会看见有一个新建的 **新项 #1**, 这个就是你创建的二级菜单子文件,
      现在右键单击重命名, 对你创建的子菜单起个好记的名字(这个名字不会出现在桌面二级菜单, 内部使用),
      自定义, 尽量字母或英文, 避免出现不必要的麻烦;
   #. 这里我改为了 CSDN, 新建项的右方会有一个默认的字符串值, 双击打开编辑,
      这里创建自定义名称, 就是桌面你想显示的软件名称;
   #. 在这个新建的文件内右键点击新建一个字符串值(重命名为 **Icon** [#f1]_),
      来存放二级菜单内要显示的软件的图标;
   #. 双击打开创建的 Icon 字符串进行编辑, 放入软件路径默认显示软件图标,
      可以自己制作 icon 图标进行自定义;
   #. 接着按相同的步骤在自己刚创建二级菜单子文件里面创建一个项, 不是字符串值, 是项! 是项! 是项!
      项的名字重命名为 **command**, 这个里面存放二级菜单子文件软件路径;
   #. 双击 command 右边框中的字符串值, 在弹出的编辑框中,
      数值数据输入你所要在二级菜单目录下显示的软件的路径;

#. 在注册表中找到这个地方 ``HKEY_CLASSES_ROOT\Directory\Background\shell``

   #. 新建一个项, 名字自定义
   #. 这个项里面创建两个字符串值文件:
      - 一个重命名为 Icon [#f1]_, 放图标路径, 自定义, 这个就参照上面详细介绍

      - 另一个是把子菜单项链接过来的, 重命名 **SubCommands**,
	注意大小写, 把刚才创建的子菜单项名字输入到这个里面,
	如果要放多个的话, **英文分号** 隔开;


.. rubric:: 备注

.. [#f1] Icon 不是必须的;
